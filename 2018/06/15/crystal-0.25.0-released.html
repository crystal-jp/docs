<!DOCTYPE html>
<html lang='en'>
  <head>
    <title>Crystal 0.25.0 released! - The Crystal Programming Language</title>
    <meta charset='utf-8'>
    <!-- Import Google Icon Font -->
    <link href='https://fonts.googleapis.com/icon?family=Material+Icons|Roboto+Mono' rel='stylesheet'>
    <link href="/assets/stylesheet.css" rel="stylesheet" />
    <link href='/feed.xml' rel='alternate' title='Atom 1.0' type='application/atom+xml'>
    <link href='/favicon.png' rel='icon' type='image/png'>
    <link href='/favicon.ico' rel='shortcut icon' type='image/x-icon'>
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Crystal 0.25.0 released! | プログラミング言語 Crystal</title>
<meta name="generator" content="Jekyll v4.2.1" />
<meta property="og:title" content="Crystal 0.25.0 released!" />
<meta name="author" content="bcardiff" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Crystal 0.25.0 has been released!" />
<meta property="og:description" content="Crystal 0.25.0 has been released!" />
<link rel="canonical" href="https://ja.crystal-lang.org/2018/06/15/crystal-0.25.0-released.html" />
<meta property="og:url" content="https://ja.crystal-lang.org/2018/06/15/crystal-0.25.0-released.html" />
<meta property="og:site_name" content="プログラミング言語 Crystal" />
<meta property="og:image" content="https://ja.crystal-lang.org/assets/icon.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-06-15T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://ja.crystal-lang.org/assets/icon.png" />
<meta property="twitter:title" content="Crystal 0.25.0 released!" />
<meta name="twitter:site" content="@CrystalLanguage" />
<meta name="twitter:creator" content="@bcardiff" />
<script type="application/ld+json">
{"datePublished":"2018-06-15T00:00:00+00:00","dateModified":"2018-06-15T00:00:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://ja.crystal-lang.org/2018/06/15/crystal-0.25.0-released.html"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ja.crystal-lang.org/assets/media/crystal_logo.svg"},"name":"bcardiff"},"url":"https://ja.crystal-lang.org/2018/06/15/crystal-0.25.0-released.html","author":{"@type":"Person","name":"bcardiff"},"@type":"BlogPosting","image":"https://ja.crystal-lang.org/assets/icon.png","headline":"Crystal 0.25.0 released!","description":"Crystal 0.25.0 has been released!","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <!-- Let browser know website is optimized for mobile -->
    <meta content='width=device-width, initial-scale=1.0' name='viewport'>
    <script src='https://code.jquery.com/jquery-3.1.1.min.js' type='text/javascript'></script>
  </head>
  <body>
    <div class="wrapper ">
  <nav role='navigation'>
  <div class='nav-wrapper no-select'>
    
      <a class='brand-logo' id='logo-container'>
        <canvas height='120' id='logo-canvas' style='cursor:move' width='120'></canvas>
      </a>
    
    <ul class='right hide-on-med-and-down' id='nav-desktop'>
      
<li>
    <a href="/">
      Home
    </a>
  </li>
<li>
    <a href="https://forum.crystal-lang.org" target="_blank">
      Forum
    </a>
  </li>
<li>
    <a href="/blog/">
      Blog
    </a>
  </li>
<li>
    <a href="/sponsors/">
      Sponsors
    </a>
  </li>
<li>
    <a href="/community/">
      Community
    </a>
  </li>
<li>
    <a href="/conference/">
      Conference
    </a>
  </li>
<li>
    <a href="/team/">
      Team
    </a>
  </li>
<li>
    <a href="/docs/">
      Docs
    </a>
  </li>
<li>
    <a href="https://github.com/crystal-lang/crystal" target="_blank">
      GitHub
    </a>
  </li>


    </ul>
    <ul class='side-nav' id='nav-mobile'>
      
<li>
    <a href="/">
      Home
    </a>
  </li>
<li>
    <a href="https://forum.crystal-lang.org" target="_blank">
      Forum
    </a>
  </li>
<li>
    <a href="/blog/">
      Blog
    </a>
  </li>
<li>
    <a href="/sponsors/">
      Sponsors
    </a>
  </li>
<li>
    <a href="/community/">
      Community
    </a>
  </li>
<li>
    <a href="/conference/">
      Conference
    </a>
  </li>
<li>
    <a href="/team/">
      Team
    </a>
  </li>
<li>
    <a href="/docs/">
      Docs
    </a>
  </li>
<li>
    <a href="https://github.com/crystal-lang/crystal" target="_blank">
      GitHub
    </a>
  </li>


    </ul>
    <a class='button-collapse' data-activates='nav-mobile' href='#'>
      <i class='material-icons'>menu</i>
    </a>
  </div>
</nav>


  <div class='post-header'>
  <div class="container">
    <div class='valign row'>
      <div class="col m2"></div>
      <div class="col s12 m9">
        <div class="author small">
          
          
            <img src="/assets/authors/bcardiff.jpg" />
          
          
            <span class="author_name">Brian J. Cardiff</span>
          
          <span class="date">15 Jun 2018</span>
        </div>

        <h1 class='title'>Crystal 0.25.0 released!</h1>
      </div>
      <div class="col m1"></div>
    </div>
  </div>
</div>


<main>
  <div class="container">
    <div class="row post-layout">
      <div class="col m2 share">
        <p class="title small share-title">Share</p>
        <div class="share-list">
          
          <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fja.crystal-lang.org%2F2018%2F06%2F15%2Fcrystal-0.25.0-released.html&text=Crystal+0.25.0+released%21&via=CrystalLanguage" target="_blank">
            <div class="share-item"><i class="extra-icons twitter gray"></i></div>
          </a>
          <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fja.crystal-lang.org%2F2018%2F06%2F15%2Fcrystal-0.25.0-released.html" target="_blank">
            <div class="share-item"><i class="extra-icons facebook gray"></i></div>
          </a>
          <a href="https://plus.google.com/share?url=https%3A%2F%2Fja.crystal-lang.org%2F2018%2F06%2F15%2Fcrystal-0.25.0-released.html" target="_blank">
            <div class="share-item"><i class="extra-icons google_plus gray"></i></div>
            </a>
        </div>
      </div>

      <div class="col s12 m9">
        <p><a href="https://github.com/crystal-lang/crystal/releases/tag/0.25.0">Crystal 0.25.0</a> has been released!</p>

<p>As every release, it includes numerous bugfixes, cool features and performance improvements - in <a href="https://github.com/crystal-lang/crystal/compare/0.24.2...0.25.0">400 commits since 0.24.2</a> from 47 contributors. There needs to be a special mention to <a href="https://github.com/MakeNowJust">@MakeNowJust</a>, <a href="https://github.com/straight-shoota">@straight-shoota</a>, <a href="https://github.com/Sija">@Sija</a> and <a href="https://github.com/bew">@bew</a> for their hard work in this release.</p>

<p>There were a ton of contributions merged in master even before 0.24.2 was released. But since 0.24.2 was already changing the release packaging for linux, changing the CI and fixing 0.24.1, some features needed to wait their turn a little longer.</p>

<p>Once again, we have tested this release by compiling some of the most popular crystal shards. This helps us catch and fix unintended breaking changes earlier in the release cycle as well as submitting PRs to the shards and contributing a bit more with the community. This process is codified using the scripts in the <a href="https://github.com/bcardiff/test-ecosystem">test-ecosystem</a> repository, which is still fairly new, but so far it’s working well.</p>

<p>The least visible work usually goes in infrastructure and there are always improvements and things waiting to be done. The latest news regarding this area are:</p>

<ul>
  <li>Docs in master <a href="https://github.com/crystal-lang/crystal/pull/5941">are back</a>. For every PR that is merged the docs at HEAD can be found at <a href="https://crystal-lang.org/api/master/">/api/master/</a>.</li>
  <li>Improved SEO by adding a canonical url for online docs <a href="https://github.com/crystal-lang/crystal/pull/5990">#5990</a>.</li>
  <li>Also on docs, lots of improvements regarding navigation have been done in <a href="https://github.com/crystal-lang/crystal/pull/5229">#5229</a>.</li>
  <li>The automated release process now cares about 32 bits linux releases. As a bonus point the packaging has been aligned again with respect to the 64 bits packages. So some paths have changed.</li>
  <li>We’ve <a href="https://github.com/crystal-lang/heroku-buildpack-crystal/issues/30">been contacted</a> by Heroku to early register our buildpack. Stay tuned to future Heroku news to update to the <code class="language-crystal highlighter-rouge"><span class="n">crystal</span><span class="o">-</span><span class="n">lang</span><span class="o">/</span><span class="n">crystal</span></code> buildpack in the registry. All in all it’s one more taste of the adoption of Crystal out there, and we are thrilled.</li>
</ul>

<p>Nightly packages in <code class="language-crystal highlighter-rouge"><span class="n">nightly</span><span class="p">.</span><span class="nf">crystal</span><span class="o">-</span><span class="n">lang</span><span class="p">.</span><span class="nf">org</span></code> are still down. The workaround for now it to use the docker image <code class="language-crystal highlighter-rouge"><span class="n">crystallang</span><span class="o">/</span><span class="n">crystal</span><span class="ss">:nightly</span></code>.</p>

<h1 id="exciting-features">Exciting features</h1>

<h2 id="shards-is-updated-to-080">Shards is updated to 0.8.0</h2>

<p>There are some performance improvements in shards for this release, by downloading less information when possible. A new global cache was added, so you don’t need to download your favorite shards over and over on all of your favorites projects. FYI you can use shards 0.8.0 with Crystal 0.24.2 if you want.</p>

<p>Read more <a href="https://github.com/crystal-lang/shards/releases/tag/v0.8.0">here</a>.</p>

<h2 id="automatic-casts-for-literal-values">Automatic casts for literal values</h2>

<p>If a method is defined as <code class="language-crystal highlighter-rouge"><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">x</span> <span class="p">:</span> <span class="no">Int8</span><span class="p">)</span></code> or <code class="language-crystal highlighter-rouge"><span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="n">color</span> <span class="p">:</span> <span class="no">Color</span><span class="p">)</span></code> with</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="code_section"><code><span class="n">enum</span> <span class="no">Color</span>
  <span class="no">Red</span>
  <span class="no">Green</span>
  <span class="no">Blue</span>
<span class="k">end</span>
</code></pre></div></div>

<p>up to 0.24 you would need to call them as <code class="language-crystal highlighter-rouge"><span class="n">foo</span><span class="p">(</span><span class="mi">1</span><span class="n">i8</span><span class="p">)</span></code> or <code class="language-crystal highlighter-rouge"><span class="n">bar</span><span class="p">(</span><span class="no">Color</span><span class="o">::</span><span class="no">Blue</span><span class="p">)</span></code>. But since 0.25.0 you will be able to <code class="language-crystal highlighter-rouge"><span class="n">foo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></code> and <code class="language-crystal highlighter-rouge"><span class="n">bar</span><span class="p">(</span><span class="ss">:blue</span><span class="p">)</span></code>. A note of caution: this only work with <em>literal values</em>. If the value is saved in a variable and used as an argument it won’t work.</p>

<p>This feature allows cleaner code without sacrificing safety. Read more at <a href="https://github.com/crystal-lang/crystal/pull/6074">#6074</a>.</p>

<h2 id="user-defined-annotations-and-jsonyamlserializable">User defined annotations and <code class="language-crystal highlighter-rouge"><span class="p">[</span><span class="no">JSON</span><span class="o">|</span><span class="no">YAML</span><span class="p">]</span><span class="o">::</span><span class="no">Serializable</span></code></h2>

<p>This new language construct allows the user to define their own annotations, like <code class="language-crystal highlighter-rouge"><span class="p">[</span><span class="no">Link</span><span class="p">]</span></code>. Basically you will be able to annotate types declaration or instance variables, and later on query them to do something you wish in macros.</p>

<p>Before this feature metaprogramming usually involved calling one macro with all the information needed. From now on, a more decoupled mechanism between declaring and consuming can be used. Read more at <a href="https://github.com/crystal-lang/crystal/pull/6063">#6063</a>.</p>

<p>The new <code class="language-crystal highlighter-rouge"><span class="no">JSON</span><span class="o">::</span><span class="no">Serializable</span></code> and <code class="language-crystal highlighter-rouge"><span class="no">YAML</span><span class="o">::</span><span class="no">Serializable</span></code> modules use this annotations. Feedback is welcome since this feature is brand new. You can read more at <a href="https://github.com/crystal-lang/crystal/pull/6082">#6082</a>, <a href="https://crystal-lang.org/api/JSON/Serializable.html">JSON::Serializable</a>, <a href="https://crystal-lang.org/api/YAML/Serializable.html">YAML::Serializable</a> docs.</p>

<p>Another usage of annotations might be to declare a registry of classes, like the one used in <code class="language-crystal highlighter-rouge"><span class="no">DB</span></code> drivers or frameworks handlers. And it could enable the removal of mutating values of constants during compilation time in favor of a more declarative code.</p>

<h2 id="do-not-collapse-unions-for-sibling-types">Do not collapse unions for sibling types</h2>

<p>Code is worth a thousand words (you know, like pictures):</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="code_section"><code><span class="k">class</span> <span class="nc">Foo</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Bar</span> <span class="o">&lt;</span> <span class="no">Foo</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Baz</span> <span class="o">&lt;</span> <span class="no">Foo</span>
<span class="k">end</span>

<span class="n">var</span> <span class="o">=</span> <span class="nb">rand</span> <span class="o">&lt;</span> <span class="mf">0.5</span> <span class="p">?</span> <span class="no">Bar</span><span class="p">.</span><span class="nf">new</span> <span class="p">:</span> <span class="no">Baz</span><span class="p">.</span><span class="nf">new</span>
<span class="n">typeof</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="c1">#=&gt; Bar | Baz</span>
</code></pre></div></div>

<p>Up to 0.24.2 the result was <code class="language-crystal highlighter-rouge"><span class="n">typeof</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="c1">#=&gt; Foo</span></code>.</p>

<p>Although the previous code already compiled fine in 0.24.2 this changes allow the type system to deal with some cases that would have ended in a compile-time error but that actually make sense. At the end of the day the type system is about identifying which programs will safely run and cutting the ones that won’t.</p>

<p>The following program is an example of that. It won’t compile in 0.24.2 but it now does in 0.25.0.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="code_section"><code><span class="k">class</span> <span class="nc">Foo</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Bar</span> <span class="o">&lt;</span> <span class="no">Foo</span>
  <span class="k">def</span> <span class="nf">do_it</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Baz</span> <span class="o">&lt;</span> <span class="no">Foo</span>
  <span class="k">def</span> <span class="nf">do_it</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Qux</span> <span class="o">&lt;</span> <span class="no">Foo</span>
  <span class="c1"># there is no do_it</span>
<span class="k">end</span>

<span class="n">var</span> <span class="o">=</span> <span class="nb">rand</span> <span class="o">&lt;</span> <span class="mf">0.5</span> <span class="p">?</span> <span class="no">Bar</span><span class="p">.</span><span class="nf">new</span> <span class="p">:</span> <span class="no">Baz</span><span class="p">.</span><span class="nf">new</span>
<span class="n">var</span><span class="p">.</span><span class="nf">do_it</span>
</code></pre></div></div>

<p>This is particularly useful in scenarios where there is a huge hierarchy of types but in a section of the code only a subset is used.</p>

<p>You can read more at <a href="https://github.com/crystal-lang/crystal/pull/6024">#6024</a> and discover when the union of types are still collapsed to the common ancestor (spoiler, they need to not be siblings).</p>

<h2 id="jsonany-and-yamlany-changes"><code class="language-crystal highlighter-rouge"><span class="no">JSON</span><span class="o">::</span><span class="no">Any</span></code> and <code class="language-crystal highlighter-rouge"><span class="no">YAML</span><span class="o">::</span><span class="no">Any</span></code> changes</h2>

<p>There were some subtle inconsistencies with <code class="language-crystal highlighter-rouge"><span class="no">JSON</span><span class="o">::</span><span class="no">Any</span></code> and <code class="language-crystal highlighter-rouge"><span class="no">YAML</span><span class="o">::</span><span class="no">Any</span></code> API. The bottom line is that over an <code class="language-crystal highlighter-rouge"><span class="o">::</span><span class="no">Any</span></code> value you can use <code class="language-crystal highlighter-rouge"><span class="c1">#[]</span></code> to traverse it and it will <em>always</em> return an <code class="language-crystal highlighter-rouge"><span class="o">::</span><span class="no">Any</span></code> value. If you need a specific type for the <code class="language-crystal highlighter-rouge"><span class="o">::</span><span class="no">Any</span></code> value (and be able to use <code class="language-crystal highlighter-rouge"><span class="no">Enumerable</span></code> methods if it was an array) you need to call the already known <code class="language-crystal highlighter-rouge"><span class="c1">#as_a</span></code>, <code class="language-crystal highlighter-rouge"><span class="c1">#as_h</span></code>, <code class="language-crystal highlighter-rouge"><span class="c1">#as_s</span></code> methods.</p>

<p>We still encourage, when possible, the use of <code class="language-crystal highlighter-rouge"><span class="no">JSON</span><span class="p">.</span><span class="nf">mapping</span></code>, <code class="language-crystal highlighter-rouge"><span class="no">JSON</span><span class="o">::</span><span class="no">Serializable</span></code> or <code class="language-crystal highlighter-rouge"><span class="no">JSON</span><span class="o">::</span><span class="no">PullParser</span></code> when finer control is needed.</p>

<p>Read more at <a href="https://github.com/crystal-lang/crystal/pull/5183">#5183</a> and in the <a href="https://crystal-lang.org/api/JSON/Any.html">JSON::Any</a> and <a href="https://crystal-lang.org/api/YAML/Any.html">YAML::Any</a> docs.</p>

<h2 id="httpserver-can-bind-to-multiple-addresses"><code class="language-crystal highlighter-rouge"><span class="no">HTTP</span><span class="o">::</span><span class="no">Server</span></code> can bind to multiple addresses</h2>

<p>This will break lots of presentations and even <a href="https://github.com/crystal-lang/crystal-website/pull/63">the code shown in our own homepage</a> but the benefits are great.</p>

<p>From now on if you use the built-in <code class="language-crystal highlighter-rouge"><span class="no">HTTP</span><span class="o">::</span><span class="no">Server</span></code> you first need to configure it, then bind to one or more addresses, and lastly you listen to all of them. These addresses can be TCP ports or Unix sockets.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="code_section"><code><span class="nb">require</span> <span class="s2">"http/server"</span>

<span class="n">server</span> <span class="o">=</span> <span class="no">HTTP</span><span class="o">::</span><span class="no">Server</span><span class="p">.</span><span class="nf">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span>
  <span class="n">context</span><span class="p">.</span><span class="nf">response</span><span class="p">.</span><span class="nf">content_type</span> <span class="o">=</span> <span class="s2">"text/plain"</span>
  <span class="n">context</span><span class="p">.</span><span class="nf">response</span><span class="p">.</span><span class="nf">print</span> <span class="s2">"Hello world, got </span><span class="si">#{</span><span class="n">context</span><span class="p">.</span><span class="nf">request</span><span class="p">.</span><span class="nf">path</span><span class="si">}</span><span class="s2">!"</span>
<span class="k">end</span>

<span class="n">server</span><span class="p">.</span><span class="nf">bind_tcp</span> <span class="s2">"0.0.0.0"</span><span class="p">,</span> <span class="mi">8080</span>
<span class="n">server</span><span class="p">.</span><span class="nf">bind_unix</span> <span class="s2">"/tmp/app.sock"</span>
<span class="n">server</span><span class="p">.</span><span class="nf">listen</span>
</code></pre></div></div>

<p>There is still a shortcut to bind and listen, but it doesn’t avoid a breaking change. Read more at <a href="https://github.com/crystal-lang/crystal/pull/5776">#5776</a>, <a href="https://github.com/crystal-lang/crystal/pull/5959">#5959</a>, and the <a href="https://crystal-lang.org/api/HTTP/Server.html">HTTP::Server</a> docs</p>

<h2 id="welcome-to-the-timezone-jungle">Welcome to the TimeZone Jungle</h2>

<p>There was a huge refactor in <code class="language-crystal highlighter-rouge"><span class="no">Time</span></code>. If you hit a unicorn while opening <a href="https://github.com/crystal-lang/crystal/pull/5324">the PR</a> to read more about it, just try again.</p>

<p>Starting now <code class="language-crystal highlighter-rouge"><span class="no">Time</span></code> has <code class="language-crystal highlighter-rouge"><span class="c1">#location</span></code> and <code class="language-crystal highlighter-rouge"><span class="c1">#offset</span></code> properties to know the timezone exactly. <code class="language-crystal highlighter-rouge"><span class="no">Time</span><span class="p">.</span><span class="nf">now</span></code> and <code class="language-crystal highlighter-rouge"><span class="no">Time</span><span class="p">.</span><span class="nf">new</span></code> will return by default information in the local timezone, while <code class="language-crystal highlighter-rouge"><span class="no">Time</span><span class="p">.</span><span class="nf">utc_now</span></code> and <code class="language-crystal highlighter-rouge"><span class="no">Time</span><span class="p">.</span><span class="nf">utc</span></code> will return information in UTC.</p>

<p>Methods like <code class="language-crystal highlighter-rouge"><span class="c1">#to_local</span></code>, <code class="language-crystal highlighter-rouge"><span class="c1">#to_utc</span></code>, <code class="language-crystal highlighter-rouge"><span class="c1">#utc?</span></code>, <code class="language-crystal highlighter-rouge"><span class="c1">#local?</span></code> and <code class="language-crystal highlighter-rouge"><span class="c1">#in(location : Location)</span></code> will help you to move around the globe faster than a plane.</p>

<p>The API even allows you to use custom timezones and fixed offsets with <code class="language-crystal highlighter-rouge"><span class="no">Time</span><span class="o">::</span><span class="no">Location</span><span class="p">.</span><span class="nf">fixed</span></code>.</p>

<p>Another change in the <code class="language-crystal highlighter-rouge"><span class="no">Time</span></code> namespace are formatters. Better formatters for ISO 8601, RFC 3339, RFC 2822, HTTP enconded dates, YAML and other places where time was parsed or emitted now use a custom time formatter that deals with more cases as expected in each scenario.</p>

<p>Read more at <a href="https://github.com/crystal-lang/crystal/pull/5324">#5324</a> and <a href="https://github.com/crystal-lang/crystal/pull/5123">#5123</a> and <a href="https://crystal-lang.org/api/Time.html">Time</a>, and <a href="https://crystal-lang.org/api/Time/Format.html">Format</a> docs.</p>

<h2 id="replace-filestat-with-fileinfo-and-other-file-api-changes">Replace <code class="language-crystal highlighter-rouge"><span class="no">File</span><span class="o">::</span><span class="no">Stat</span></code> with <code class="language-crystal highlighter-rouge"><span class="no">File</span><span class="o">::</span><span class="no">Info</span></code> and other file API changes</h2>

<p>Some time ago an abstraction for the running OS was introduced in the stdlib. The goal was to be able to run the Crystal compiler in a non POSIX platform and keep the stdlib as clean as possible. Feel free to check <a href="https://github.com/crystal-lang/crystal/tree/master/src/crystal/system">src/crystal/system</a>, but keep in mind it is not intended as a public API.</p>

<p>This also required to pick names and abstractions in the stdlib that will fit everybody: POSIX and non POSIX.</p>

<p>The API was renamed and reworked for compare operations and accessing file properties and permissions. It is much clearer now. Hopefully it doesn’t affect too many users, since most of us use <code class="language-crystal highlighter-rouge"><span class="no">File</span><span class="p">.</span><span class="nf">open</span></code>, <code class="language-crystal highlighter-rouge"><span class="no">File</span><span class="p">.</span><span class="nf">write</span></code> and move on. Read more at <a href="https://github.com/crystal-lang/crystal/pull/5584">#5584</a>, <a href="https://github.com/crystal-lang/crystal/pull/5333">#5333</a>, <a href="https://github.com/crystal-lang/crystal/pull/5553">#5553</a>, <a href="https://github.com/crystal-lang/crystal/pull/6161">#6161</a>, <a href="https://crystal-lang.org/api/File.html">File</a> and <a href="https://crystal-lang.org/api/File/Info.html">File::Info</a> docs.</p>

<h2 id="heredoc-on-every-argument">Heredoc on every argument</h2>

<p>If you use Heredoc a lot of you might be interested in this one. Up to 0.24.2 if you wanted to call a method on a string specified using Heredoc you would do:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="code_section"><code><span class="nb">puts</span> <span class="o">&lt;&lt;-</span><span class="no">FOO</span><span class="sh">
  message
  FOO.downcase
</span></code></pre></div></div>

<p>From now on the method needs to be at the initial delimiter</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="code_section"><code><span class="nb">puts</span> <span class="o">&lt;&lt;-</span><span class="no">FOO</span><span class="p">.</span><span class="nf">downcase</span><span class="sh">
  message
</span><span class="no">  FOO</span>
</code></pre></div></div>

<p>It’s subtle but important, and it plays better with multiple Heredocs in a single call now that you can:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="code_section"><code><span class="nb">puts</span> <span class="o">&lt;&lt;-</span><span class="no">ONE</span><span class="p">.</span><span class="nf">upcase</span><span class="p">,</span> <span class="o">&lt;&lt;-</span><span class="no">TWO</span><span class="p">.</span><span class="nf">capitalize</span><span class="sh">
  hello world
</span><span class="no">  ONE</span><span class="sh">
  second message
</span><span class="no">  TWO</span>
</code></pre></div></div>

<p>Read more at <a href="https://github.com/crystal-lang/crystal/pull/5578">#5578</a>.</p>

<h2 id="macro-verbatim-blocks">Macro verbatim blocks</h2>

<p>If you deal with escaped macros don’t miss <a href="https://github.com/crystal-lang/crystal/pull/6108">#6108</a>.</p>

<p>Macros are powerful and they should be used <em>after</em> there is a boilerplate pattern discovered.</p>

<p>This new language construct helps when the macro itself will define, for example, methods that have macro blocks that should be expanded later (i.e. nested macros).</p>

<p>It may result in a nicer way to express the same things you could before with some <code class="language-crystal highlighter-rouge"><span class="p">\{%</span> <span class="n">escaping</span> <span class="p">%}</span></code>.</p>

<h1 id="other-notable-changes-breaking-or-not">Other notable changes (breaking or not)</h1>

<ul>
  <li><code class="language-crystal highlighter-rouge"><span class="n">crystal</span> <span class="n">deps</span></code> is dead, long live <code class="language-crystal highlighter-rouge"><span class="n">shards</span> <span class="n">install</span></code>. <a href="https://github.com/crystal-lang/crystal/pull/5544">#5544</a>. Unless we removed it, you would never have updated <a href="https://github.com/crystal-lang/heroku-buildpack-crystal/commit/b85da4da408e45770922715288b80dc089568e08">your build scripts</a>.</li>
  <li>Use <code class="language-crystal highlighter-rouge"><span class="no">Hash</span><span class="c1">#key_for</span></code> to perform a reverse lookup in a hash <a href="https://github.com/crystal-lang/crystal/pull/5444">#5444</a> #NamesAreHard.</li>
  <li>The block argument from <code class="language-crystal highlighter-rouge"><span class="kp">loop</span></code> was removed <a href="https://github.com/crystal-lang/crystal/pull/6026">#6026</a>.</li>
  <li>Fix <code class="language-crystal highlighter-rouge"><span class="no">File</span><span class="p">.</span><span class="nf">join</span></code> with empty path component <a href="https://github.com/crystal-lang/crystal/pull/5915">#5915</a>.</li>
  <li><code class="language-crystal highlighter-rouge"><span class="no">Colorize</span><span class="c1">#push</span></code> is dead, long live <code class="language-crystal highlighter-rouge"><span class="no">Colorize</span><span class="c1">#surround</span></code><a href="https://github.com/crystal-lang/crystal/pull/4196">#4196</a>. Bonus point, your <code class="language-crystal highlighter-rouge"><span class="c1">#to_s</span></code> can use your favorite color now.</li>
  <li>Punycode is a special encoding used to convert Unicode characters to ASCII and is used to encode internationalized domain names (IDN). And now they are available in Crystal thanks to <a href="https://github.com/crystal-lang/crystal/pull/2543">#2543</a>.</li>
  <li><code class="language-crystal highlighter-rouge"><span class="n">pp</span></code> no longer prints the expression. But <code class="language-crystal highlighter-rouge"><span class="n">pp!</span></code> and the new <code class="language-crystal highlighter-rouge"><span class="nb">p</span><span class="o">!</span></code> will. <code class="language-crystal highlighter-rouge"><span class="nb">p</span></code> stands for print, <code class="language-crystal highlighter-rouge"><span class="n">pp</span></code> for pretty print and <code class="language-crystal highlighter-rouge"><span class="o">!</span></code> for show me the <del>money</del> expression <a href="https://github.com/crystal-lang/crystal/pull/6044">#6044</a>.</li>
</ul>

<h1 id="next-step">Next step</h1>

<p>Please update your Crystal and report any issues. If there are regression or blocking issues with 0.25.0, a 0.25.1 could be released earlier.</p>

<p>Don’t miss the rest of the <a href="https://github.com/crystal-lang/crystal/releases/tag/0.25.0">release changelog</a> information with lots of other fixes.</p>

<p>The development is possible thanks to the community’s effort, <a href="https://www.84codes.com/">84codes</a>’ support, and every <a href="https://crystal-lang.org/sponsors">BountySource supporter</a>.</p>


      </div>
      <div class="col m1"></div>
    </div>

    <div class="row disqus">
      <div class="col m2"></div>
      <div class="col s12 m9" id='disqus_thread'>
        <p><a href="https://github.com/crystal-lang/crystal/releases/tag/0.25.0">Crystal 0.25.0</a> has been released!</p>

<p>As every release, it includes numerous bugfixes, cool features and performance improvements - in <a href="https://github.com/crystal-lang/crystal/compare/0.24.2...0.25.0">400 commits since 0.24.2</a> from 47 contributors. There needs to be a special mention to <a href="https://github.com/MakeNowJust">@MakeNowJust</a>, <a href="https://github.com/straight-shoota">@straight-shoota</a>, <a href="https://github.com/Sija">@Sija</a> and <a href="https://github.com/bew">@bew</a> for their hard work in this release.</p>

<p>There were a ton of contributions merged in master even before 0.24.2 was released. But since 0.24.2 was already changing the release packaging for linux, changing the CI and fixing 0.24.1, some features needed to wait their turn a little longer.</p>

<p>Once again, we have tested this release by compiling some of the most popular crystal shards. This helps us catch and fix unintended breaking changes earlier in the release cycle as well as submitting PRs to the shards and contributing a bit more with the community. This process is codified using the scripts in the <a href="https://github.com/bcardiff/test-ecosystem">test-ecosystem</a> repository, which is still fairly new, but so far it’s working well.</p>

<p>The least visible work usually goes in infrastructure and there are always improvements and things waiting to be done. The latest news regarding this area are:</p>

<ul>
  <li>Docs in master <a href="https://github.com/crystal-lang/crystal/pull/5941">are back</a>. For every PR that is merged the docs at HEAD can be found at <a href="https://crystal-lang.org/api/master/">/api/master/</a>.</li>
  <li>Improved SEO by adding a canonical url for online docs <a href="https://github.com/crystal-lang/crystal/pull/5990">#5990</a>.</li>
  <li>Also on docs, lots of improvements regarding navigation have been done in <a href="https://github.com/crystal-lang/crystal/pull/5229">#5229</a>.</li>
  <li>The automated release process now cares about 32 bits linux releases. As a bonus point the packaging has been aligned again with respect to the 64 bits packages. So some paths have changed.</li>
  <li>We’ve <a href="https://github.com/crystal-lang/heroku-buildpack-crystal/issues/30">been contacted</a> by Heroku to early register our buildpack. Stay tuned to future Heroku news to update to the <code class="language-crystal highlighter-rouge"><span class="n">crystal</span><span class="o">-</span><span class="n">lang</span><span class="o">/</span><span class="n">crystal</span></code> buildpack in the registry. All in all it’s one more taste of the adoption of Crystal out there, and we are thrilled.</li>
</ul>

<p>Nightly packages in <code class="language-crystal highlighter-rouge"><span class="n">nightly</span><span class="p">.</span><span class="nf">crystal</span><span class="o">-</span><span class="n">lang</span><span class="p">.</span><span class="nf">org</span></code> are still down. The workaround for now it to use the docker image <code class="language-crystal highlighter-rouge"><span class="n">crystallang</span><span class="o">/</span><span class="n">crystal</span><span class="ss">:nightly</span></code>.</p>

<h1 id="exciting-features">Exciting features</h1>

<h2 id="shards-is-updated-to-080">Shards is updated to 0.8.0</h2>

<p>There are some performance improvements in shards for this release, by downloading less information when possible. A new global cache was added, so you don’t need to download your favorite shards over and over on all of your favorites projects. FYI you can use shards 0.8.0 with Crystal 0.24.2 if you want.</p>

<p>Read more <a href="https://github.com/crystal-lang/shards/releases/tag/v0.8.0">here</a>.</p>

<h2 id="automatic-casts-for-literal-values">Automatic casts for literal values</h2>

<p>If a method is defined as <code class="language-crystal highlighter-rouge"><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">x</span> <span class="p">:</span> <span class="no">Int8</span><span class="p">)</span></code> or <code class="language-crystal highlighter-rouge"><span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="n">color</span> <span class="p">:</span> <span class="no">Color</span><span class="p">)</span></code> with</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="code_section"><code><span class="n">enum</span> <span class="no">Color</span>
  <span class="no">Red</span>
  <span class="no">Green</span>
  <span class="no">Blue</span>
<span class="k">end</span>
</code></pre></div></div>

<p>up to 0.24 you would need to call them as <code class="language-crystal highlighter-rouge"><span class="n">foo</span><span class="p">(</span><span class="mi">1</span><span class="n">i8</span><span class="p">)</span></code> or <code class="language-crystal highlighter-rouge"><span class="n">bar</span><span class="p">(</span><span class="no">Color</span><span class="o">::</span><span class="no">Blue</span><span class="p">)</span></code>. But since 0.25.0 you will be able to <code class="language-crystal highlighter-rouge"><span class="n">foo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span></code> and <code class="language-crystal highlighter-rouge"><span class="n">bar</span><span class="p">(</span><span class="ss">:blue</span><span class="p">)</span></code>. A note of caution: this only work with <em>literal values</em>. If the value is saved in a variable and used as an argument it won’t work.</p>

<p>This feature allows cleaner code without sacrificing safety. Read more at <a href="https://github.com/crystal-lang/crystal/pull/6074">#6074</a>.</p>

<h2 id="user-defined-annotations-and-jsonyamlserializable">User defined annotations and <code class="language-crystal highlighter-rouge"><span class="p">[</span><span class="no">JSON</span><span class="o">|</span><span class="no">YAML</span><span class="p">]</span><span class="o">::</span><span class="no">Serializable</span></code></h2>

<p>This new language construct allows the user to define their own annotations, like <code class="language-crystal highlighter-rouge"><span class="p">[</span><span class="no">Link</span><span class="p">]</span></code>. Basically you will be able to annotate types declaration or instance variables, and later on query them to do something you wish in macros.</p>

<p>Before this feature metaprogramming usually involved calling one macro with all the information needed. From now on, a more decoupled mechanism between declaring and consuming can be used. Read more at <a href="https://github.com/crystal-lang/crystal/pull/6063">#6063</a>.</p>

<p>The new <code class="language-crystal highlighter-rouge"><span class="no">JSON</span><span class="o">::</span><span class="no">Serializable</span></code> and <code class="language-crystal highlighter-rouge"><span class="no">YAML</span><span class="o">::</span><span class="no">Serializable</span></code> modules use this annotations. Feedback is welcome since this feature is brand new. You can read more at <a href="https://github.com/crystal-lang/crystal/pull/6082">#6082</a>, <a href="https://crystal-lang.org/api/JSON/Serializable.html">JSON::Serializable</a>, <a href="https://crystal-lang.org/api/YAML/Serializable.html">YAML::Serializable</a> docs.</p>

<p>Another usage of annotations might be to declare a registry of classes, like the one used in <code class="language-crystal highlighter-rouge"><span class="no">DB</span></code> drivers or frameworks handlers. And it could enable the removal of mutating values of constants during compilation time in favor of a more declarative code.</p>

<h2 id="do-not-collapse-unions-for-sibling-types">Do not collapse unions for sibling types</h2>

<p>Code is worth a thousand words (you know, like pictures):</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="code_section"><code><span class="k">class</span> <span class="nc">Foo</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Bar</span> <span class="o">&lt;</span> <span class="no">Foo</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Baz</span> <span class="o">&lt;</span> <span class="no">Foo</span>
<span class="k">end</span>

<span class="n">var</span> <span class="o">=</span> <span class="nb">rand</span> <span class="o">&lt;</span> <span class="mf">0.5</span> <span class="p">?</span> <span class="no">Bar</span><span class="p">.</span><span class="nf">new</span> <span class="p">:</span> <span class="no">Baz</span><span class="p">.</span><span class="nf">new</span>
<span class="n">typeof</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="c1">#=&gt; Bar | Baz</span>
</code></pre></div></div>

<p>Up to 0.24.2 the result was <code class="language-crystal highlighter-rouge"><span class="n">typeof</span><span class="p">(</span><span class="n">var</span><span class="p">)</span> <span class="c1">#=&gt; Foo</span></code>.</p>

<p>Although the previous code already compiled fine in 0.24.2 this changes allow the type system to deal with some cases that would have ended in a compile-time error but that actually make sense. At the end of the day the type system is about identifying which programs will safely run and cutting the ones that won’t.</p>

<p>The following program is an example of that. It won’t compile in 0.24.2 but it now does in 0.25.0.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="code_section"><code><span class="k">class</span> <span class="nc">Foo</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Bar</span> <span class="o">&lt;</span> <span class="no">Foo</span>
  <span class="k">def</span> <span class="nf">do_it</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Baz</span> <span class="o">&lt;</span> <span class="no">Foo</span>
  <span class="k">def</span> <span class="nf">do_it</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Qux</span> <span class="o">&lt;</span> <span class="no">Foo</span>
  <span class="c1"># there is no do_it</span>
<span class="k">end</span>

<span class="n">var</span> <span class="o">=</span> <span class="nb">rand</span> <span class="o">&lt;</span> <span class="mf">0.5</span> <span class="p">?</span> <span class="no">Bar</span><span class="p">.</span><span class="nf">new</span> <span class="p">:</span> <span class="no">Baz</span><span class="p">.</span><span class="nf">new</span>
<span class="n">var</span><span class="p">.</span><span class="nf">do_it</span>
</code></pre></div></div>

<p>This is particularly useful in scenarios where there is a huge hierarchy of types but in a section of the code only a subset is used.</p>

<p>You can read more at <a href="https://github.com/crystal-lang/crystal/pull/6024">#6024</a> and discover when the union of types are still collapsed to the common ancestor (spoiler, they need to not be siblings).</p>

<h2 id="jsonany-and-yamlany-changes"><code class="language-crystal highlighter-rouge"><span class="no">JSON</span><span class="o">::</span><span class="no">Any</span></code> and <code class="language-crystal highlighter-rouge"><span class="no">YAML</span><span class="o">::</span><span class="no">Any</span></code> changes</h2>

<p>There were some subtle inconsistencies with <code class="language-crystal highlighter-rouge"><span class="no">JSON</span><span class="o">::</span><span class="no">Any</span></code> and <code class="language-crystal highlighter-rouge"><span class="no">YAML</span><span class="o">::</span><span class="no">Any</span></code> API. The bottom line is that over an <code class="language-crystal highlighter-rouge"><span class="o">::</span><span class="no">Any</span></code> value you can use <code class="language-crystal highlighter-rouge"><span class="c1">#[]</span></code> to traverse it and it will <em>always</em> return an <code class="language-crystal highlighter-rouge"><span class="o">::</span><span class="no">Any</span></code> value. If you need a specific type for the <code class="language-crystal highlighter-rouge"><span class="o">::</span><span class="no">Any</span></code> value (and be able to use <code class="language-crystal highlighter-rouge"><span class="no">Enumerable</span></code> methods if it was an array) you need to call the already known <code class="language-crystal highlighter-rouge"><span class="c1">#as_a</span></code>, <code class="language-crystal highlighter-rouge"><span class="c1">#as_h</span></code>, <code class="language-crystal highlighter-rouge"><span class="c1">#as_s</span></code> methods.</p>

<p>We still encourage, when possible, the use of <code class="language-crystal highlighter-rouge"><span class="no">JSON</span><span class="p">.</span><span class="nf">mapping</span></code>, <code class="language-crystal highlighter-rouge"><span class="no">JSON</span><span class="o">::</span><span class="no">Serializable</span></code> or <code class="language-crystal highlighter-rouge"><span class="no">JSON</span><span class="o">::</span><span class="no">PullParser</span></code> when finer control is needed.</p>

<p>Read more at <a href="https://github.com/crystal-lang/crystal/pull/5183">#5183</a> and in the <a href="https://crystal-lang.org/api/JSON/Any.html">JSON::Any</a> and <a href="https://crystal-lang.org/api/YAML/Any.html">YAML::Any</a> docs.</p>

<h2 id="httpserver-can-bind-to-multiple-addresses"><code class="language-crystal highlighter-rouge"><span class="no">HTTP</span><span class="o">::</span><span class="no">Server</span></code> can bind to multiple addresses</h2>

<p>This will break lots of presentations and even <a href="https://github.com/crystal-lang/crystal-website/pull/63">the code shown in our own homepage</a> but the benefits are great.</p>

<p>From now on if you use the built-in <code class="language-crystal highlighter-rouge"><span class="no">HTTP</span><span class="o">::</span><span class="no">Server</span></code> you first need to configure it, then bind to one or more addresses, and lastly you listen to all of them. These addresses can be TCP ports or Unix sockets.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="code_section"><code><span class="nb">require</span> <span class="s2">"http/server"</span>

<span class="n">server</span> <span class="o">=</span> <span class="no">HTTP</span><span class="o">::</span><span class="no">Server</span><span class="p">.</span><span class="nf">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">context</span><span class="o">|</span>
  <span class="n">context</span><span class="p">.</span><span class="nf">response</span><span class="p">.</span><span class="nf">content_type</span> <span class="o">=</span> <span class="s2">"text/plain"</span>
  <span class="n">context</span><span class="p">.</span><span class="nf">response</span><span class="p">.</span><span class="nf">print</span> <span class="s2">"Hello world, got </span><span class="si">#{</span><span class="n">context</span><span class="p">.</span><span class="nf">request</span><span class="p">.</span><span class="nf">path</span><span class="si">}</span><span class="s2">!"</span>
<span class="k">end</span>

<span class="n">server</span><span class="p">.</span><span class="nf">bind_tcp</span> <span class="s2">"0.0.0.0"</span><span class="p">,</span> <span class="mi">8080</span>
<span class="n">server</span><span class="p">.</span><span class="nf">bind_unix</span> <span class="s2">"/tmp/app.sock"</span>
<span class="n">server</span><span class="p">.</span><span class="nf">listen</span>
</code></pre></div></div>

<p>There is still a shortcut to bind and listen, but it doesn’t avoid a breaking change. Read more at <a href="https://github.com/crystal-lang/crystal/pull/5776">#5776</a>, <a href="https://github.com/crystal-lang/crystal/pull/5959">#5959</a>, and the <a href="https://crystal-lang.org/api/HTTP/Server.html">HTTP::Server</a> docs</p>

<h2 id="welcome-to-the-timezone-jungle">Welcome to the TimeZone Jungle</h2>

<p>There was a huge refactor in <code class="language-crystal highlighter-rouge"><span class="no">Time</span></code>. If you hit a unicorn while opening <a href="https://github.com/crystal-lang/crystal/pull/5324">the PR</a> to read more about it, just try again.</p>

<p>Starting now <code class="language-crystal highlighter-rouge"><span class="no">Time</span></code> has <code class="language-crystal highlighter-rouge"><span class="c1">#location</span></code> and <code class="language-crystal highlighter-rouge"><span class="c1">#offset</span></code> properties to know the timezone exactly. <code class="language-crystal highlighter-rouge"><span class="no">Time</span><span class="p">.</span><span class="nf">now</span></code> and <code class="language-crystal highlighter-rouge"><span class="no">Time</span><span class="p">.</span><span class="nf">new</span></code> will return by default information in the local timezone, while <code class="language-crystal highlighter-rouge"><span class="no">Time</span><span class="p">.</span><span class="nf">utc_now</span></code> and <code class="language-crystal highlighter-rouge"><span class="no">Time</span><span class="p">.</span><span class="nf">utc</span></code> will return information in UTC.</p>

<p>Methods like <code class="language-crystal highlighter-rouge"><span class="c1">#to_local</span></code>, <code class="language-crystal highlighter-rouge"><span class="c1">#to_utc</span></code>, <code class="language-crystal highlighter-rouge"><span class="c1">#utc?</span></code>, <code class="language-crystal highlighter-rouge"><span class="c1">#local?</span></code> and <code class="language-crystal highlighter-rouge"><span class="c1">#in(location : Location)</span></code> will help you to move around the globe faster than a plane.</p>

<p>The API even allows you to use custom timezones and fixed offsets with <code class="language-crystal highlighter-rouge"><span class="no">Time</span><span class="o">::</span><span class="no">Location</span><span class="p">.</span><span class="nf">fixed</span></code>.</p>

<p>Another change in the <code class="language-crystal highlighter-rouge"><span class="no">Time</span></code> namespace are formatters. Better formatters for ISO 8601, RFC 3339, RFC 2822, HTTP enconded dates, YAML and other places where time was parsed or emitted now use a custom time formatter that deals with more cases as expected in each scenario.</p>

<p>Read more at <a href="https://github.com/crystal-lang/crystal/pull/5324">#5324</a> and <a href="https://github.com/crystal-lang/crystal/pull/5123">#5123</a> and <a href="https://crystal-lang.org/api/Time.html">Time</a>, and <a href="https://crystal-lang.org/api/Time/Format.html">Format</a> docs.</p>

<h2 id="replace-filestat-with-fileinfo-and-other-file-api-changes">Replace <code class="language-crystal highlighter-rouge"><span class="no">File</span><span class="o">::</span><span class="no">Stat</span></code> with <code class="language-crystal highlighter-rouge"><span class="no">File</span><span class="o">::</span><span class="no">Info</span></code> and other file API changes</h2>

<p>Some time ago an abstraction for the running OS was introduced in the stdlib. The goal was to be able to run the Crystal compiler in a non POSIX platform and keep the stdlib as clean as possible. Feel free to check <a href="https://github.com/crystal-lang/crystal/tree/master/src/crystal/system">src/crystal/system</a>, but keep in mind it is not intended as a public API.</p>

<p>This also required to pick names and abstractions in the stdlib that will fit everybody: POSIX and non POSIX.</p>

<p>The API was renamed and reworked for compare operations and accessing file properties and permissions. It is much clearer now. Hopefully it doesn’t affect too many users, since most of us use <code class="language-crystal highlighter-rouge"><span class="no">File</span><span class="p">.</span><span class="nf">open</span></code>, <code class="language-crystal highlighter-rouge"><span class="no">File</span><span class="p">.</span><span class="nf">write</span></code> and move on. Read more at <a href="https://github.com/crystal-lang/crystal/pull/5584">#5584</a>, <a href="https://github.com/crystal-lang/crystal/pull/5333">#5333</a>, <a href="https://github.com/crystal-lang/crystal/pull/5553">#5553</a>, <a href="https://github.com/crystal-lang/crystal/pull/6161">#6161</a>, <a href="https://crystal-lang.org/api/File.html">File</a> and <a href="https://crystal-lang.org/api/File/Info.html">File::Info</a> docs.</p>

<h2 id="heredoc-on-every-argument">Heredoc on every argument</h2>

<p>If you use Heredoc a lot of you might be interested in this one. Up to 0.24.2 if you wanted to call a method on a string specified using Heredoc you would do:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="code_section"><code><span class="nb">puts</span> <span class="o">&lt;&lt;-</span><span class="no">FOO</span><span class="sh">
  message
  FOO.downcase
</span></code></pre></div></div>

<p>From now on the method needs to be at the initial delimiter</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="code_section"><code><span class="nb">puts</span> <span class="o">&lt;&lt;-</span><span class="no">FOO</span><span class="p">.</span><span class="nf">downcase</span><span class="sh">
  message
</span><span class="no">  FOO</span>
</code></pre></div></div>

<p>It’s subtle but important, and it plays better with multiple Heredocs in a single call now that you can:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="code_section"><code><span class="nb">puts</span> <span class="o">&lt;&lt;-</span><span class="no">ONE</span><span class="p">.</span><span class="nf">upcase</span><span class="p">,</span> <span class="o">&lt;&lt;-</span><span class="no">TWO</span><span class="p">.</span><span class="nf">capitalize</span><span class="sh">
  hello world
</span><span class="no">  ONE</span><span class="sh">
  second message
</span><span class="no">  TWO</span>
</code></pre></div></div>

<p>Read more at <a href="https://github.com/crystal-lang/crystal/pull/5578">#5578</a>.</p>

<h2 id="macro-verbatim-blocks">Macro verbatim blocks</h2>

<p>If you deal with escaped macros don’t miss <a href="https://github.com/crystal-lang/crystal/pull/6108">#6108</a>.</p>

<p>Macros are powerful and they should be used <em>after</em> there is a boilerplate pattern discovered.</p>

<p>This new language construct helps when the macro itself will define, for example, methods that have macro blocks that should be expanded later (i.e. nested macros).</p>

<p>It may result in a nicer way to express the same things you could before with some <code class="language-crystal highlighter-rouge"><span class="p">\{%</span> <span class="n">escaping</span> <span class="p">%}</span></code>.</p>

<h1 id="other-notable-changes-breaking-or-not">Other notable changes (breaking or not)</h1>

<ul>
  <li><code class="language-crystal highlighter-rouge"><span class="n">crystal</span> <span class="n">deps</span></code> is dead, long live <code class="language-crystal highlighter-rouge"><span class="n">shards</span> <span class="n">install</span></code>. <a href="https://github.com/crystal-lang/crystal/pull/5544">#5544</a>. Unless we removed it, you would never have updated <a href="https://github.com/crystal-lang/heroku-buildpack-crystal/commit/b85da4da408e45770922715288b80dc089568e08">your build scripts</a>.</li>
  <li>Use <code class="language-crystal highlighter-rouge"><span class="no">Hash</span><span class="c1">#key_for</span></code> to perform a reverse lookup in a hash <a href="https://github.com/crystal-lang/crystal/pull/5444">#5444</a> #NamesAreHard.</li>
  <li>The block argument from <code class="language-crystal highlighter-rouge"><span class="kp">loop</span></code> was removed <a href="https://github.com/crystal-lang/crystal/pull/6026">#6026</a>.</li>
  <li>Fix <code class="language-crystal highlighter-rouge"><span class="no">File</span><span class="p">.</span><span class="nf">join</span></code> with empty path component <a href="https://github.com/crystal-lang/crystal/pull/5915">#5915</a>.</li>
  <li><code class="language-crystal highlighter-rouge"><span class="no">Colorize</span><span class="c1">#push</span></code> is dead, long live <code class="language-crystal highlighter-rouge"><span class="no">Colorize</span><span class="c1">#surround</span></code><a href="https://github.com/crystal-lang/crystal/pull/4196">#4196</a>. Bonus point, your <code class="language-crystal highlighter-rouge"><span class="c1">#to_s</span></code> can use your favorite color now.</li>
  <li>Punycode is a special encoding used to convert Unicode characters to ASCII and is used to encode internationalized domain names (IDN). And now they are available in Crystal thanks to <a href="https://github.com/crystal-lang/crystal/pull/2543">#2543</a>.</li>
  <li><code class="language-crystal highlighter-rouge"><span class="n">pp</span></code> no longer prints the expression. But <code class="language-crystal highlighter-rouge"><span class="n">pp!</span></code> and the new <code class="language-crystal highlighter-rouge"><span class="nb">p</span><span class="o">!</span></code> will. <code class="language-crystal highlighter-rouge"><span class="nb">p</span></code> stands for print, <code class="language-crystal highlighter-rouge"><span class="n">pp</span></code> for pretty print and <code class="language-crystal highlighter-rouge"><span class="o">!</span></code> for show me the <del>money</del> expression <a href="https://github.com/crystal-lang/crystal/pull/6044">#6044</a>.</li>
</ul>

<h1 id="next-step">Next step</h1>

<p>Please update your Crystal and report any issues. If there are regression or blocking issues with 0.25.0, a 0.25.1 could be released earlier.</p>

<p>Don’t miss the rest of the <a href="https://github.com/crystal-lang/crystal/releases/tag/0.25.0">release changelog</a> information with lots of other fixes.</p>

<p>The development is possible thanks to the community’s effort, <a href="https://www.84codes.com/">84codes</a>’ support, and every <a href="https://crystal-lang.org/sponsors">BountySource supporter</a>.</p>


      </div>
      <div class="col m1"></div>
    </div>
  </div>
</main>


  <footer>
  <div class="row">
    <div class="col s12 m12 l6 crystal">
      Crystal is licensed under the Apache License,
      <a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>
        Version 2.0
      </a>
    </div>
    <div class="col s12 m12 l6 manas right-align black-text">
      Crystal language, born & raised at
      <a href="https://manas.tech" target="_blank" class="black-text">Manas</a>
      <a href="https://manas.tech" target="_blank" class="logo">
        <i class="manas"></i>
      </a>
    </div>
  </div>
</footer>

</div>


    <script src="/assets/js/bundle.js"></script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-42353458-1', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
