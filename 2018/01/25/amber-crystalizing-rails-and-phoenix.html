<!DOCTYPE html>
<html lang='ja'>
  <head>
    <title>Amber - Crystalizing Rails and Phoenix - プログラミング言語 Crystal</title>
    <meta charset='UTF-8'>
    <!-- Import Google Icon Font -->
    <link href='https://fonts.googleapis.com/icon?family=Material+Icons|Roboto+Mono' rel='stylesheet'><link type="text/css" rel="stylesheet" href="/assets/stylesheet.css"><link href='/feed.xml' rel='alternate' title='Atom 1.0' type='application/atom+xml'>
    <link href='/favicon.png' rel='icon' type='image/png'>
    <link href='/favicon.ico' rel='shortcut icon' type='image/x-icon'><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Amber - Crystalizing Rails and Phoenix | プログラミング言語 Crystal</title>
<meta name="generator" content="Jekyll v3.9.1" />
<meta property="og:title" content="Amber - Crystalizing Rails and Phoenix" />
<meta name="author" content="robacarp" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Join Robert Carpenter, member of the Amber core team, in an introduction to this Rails-like web framework" />
<meta property="og:description" content="Join Robert Carpenter, member of the Amber core team, in an introduction to this Rails-like web framework" />
<link rel="canonical" href="https://ja.crystal-lang.org/2018/01/25/amber-crystalizing-rails-and-phoenix.html" />
<meta property="og:url" content="https://ja.crystal-lang.org/2018/01/25/amber-crystalizing-rails-and-phoenix.html" />
<meta property="og:site_name" content="プログラミング言語 Crystal" />
<meta property="og:image" content="https://ja.crystal-lang.org/assets/icon.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-01-25T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://ja.crystal-lang.org/assets/icon.png" />
<meta property="twitter:title" content="Amber - Crystalizing Rails and Phoenix" />
<meta name="twitter:site" content="@CrystalLanguage" />
<meta name="twitter:creator" content="@robacarp" />
<script type="application/ld+json">
{"dateModified":"2018-01-25T00:00:00+00:00","datePublished":"2018-01-25T00:00:00+00:00","headline":"Amber - Crystalizing Rails and Phoenix","url":"https://ja.crystal-lang.org/2018/01/25/amber-crystalizing-rails-and-phoenix.html","mainEntityOfPage":{"@type":"WebPage","@id":"https://ja.crystal-lang.org/2018/01/25/amber-crystalizing-rails-and-phoenix.html"},"image":"https://ja.crystal-lang.org/assets/icon.png","author":{"@type":"Person","name":"robacarp"},"description":"Join Robert Carpenter, member of the Amber core team, in an introduction to this Rails-like web framework","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ja.crystal-lang.org/assets/media/crystal_logo.svg"},"name":"robacarp"},"@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
 <!-- Let browser know website is optimized for mobile --><meta content='width=device-width, initial-scale=1.0' name='viewport'>
    <script src='https://code.jquery.com/jquery-3.1.1.min.js' type='text/javascript'></script>
  </head>
  <body>
    <!-- <div class="top-banner">
  <a href="https://www.eventbrite.co.uk/e/raw-crystal-2020-tickets-127439094763" target="_blank">
    <span class="tb-title">RAW CRYSTAL<span class="tb-thin"> | 2020</span></span>
    <span class="tb-gap"></span>
    <span class="tb-date">Dec 11</span>
    <span class="tb-register">REGISTER AT <em>Eventbrite</em></span>
  </a>
</div>
 -->
    <div class="wrapper "><nav role='navigation'>
  <div class='nav-wrapper no-select'>
    
      <a class='brand-logo' id='logo-container'>
        <canvas height='120' id='logo-canvas' style='cursor:move' width='120'></canvas>
      </a>
    
    <ul class='right hide-on-med-and-down' id='nav-desktop'>
      
<li>
    <a href="/">
      Home
    </a>
  </li>
<li>
    <a href="https://forum.crystal-lang.org" target="_blank">
      Forum
    </a>
  </li>
<li>
    <a href="/blog/">
      Blog
    </a>
  </li>
<li>
    <a href="/sponsors/">
      Sponsors
    </a>
  </li>
<li>
    <a href="/community/">
      Community
    </a>
  </li>
<li>
    <a href="/team/">
      Team
    </a>
  </li>
<li>
    <a href="/docs/">
      Docs
    </a>
  </li>
<li>
    <a href="https://github.com/crystal-lang/crystal" target="_blank">
      GitHub
    </a>
  </li>


    </ul>
    <ul class='side-nav' id='nav-mobile'>
      
<li>
    <a href="/">
      Home
    </a>
  </li>
<li>
    <a href="https://forum.crystal-lang.org" target="_blank">
      Forum
    </a>
  </li>
<li>
    <a href="/blog/">
      Blog
    </a>
  </li>
<li>
    <a href="/sponsors/">
      Sponsors
    </a>
  </li>
<li>
    <a href="/community/">
      Community
    </a>
  </li>
<li>
    <a href="/team/">
      Team
    </a>
  </li>
<li>
    <a href="/docs/">
      Docs
    </a>
  </li>
<li>
    <a href="https://github.com/crystal-lang/crystal" target="_blank">
      GitHub
    </a>
  </li>


    </ul>
    <a class='button-collapse' data-activates='nav-mobile' href='#'>
      <i class='material-icons'>menu</i>
    </a>
  </div>
</nav>
   <div class='post-header'>
  <div class="container">
    <div class='valign row'>
      <div class="col m2"></div>
      <div class="col s12 m9">
        <div class="author small">
          
          
            <img src="/assets/authors/robacarp.jpg" width="360" height="411" alt="authors/robacarp.jpg">
          
          
            <span class="author_name">Robert Carpenter</span>
          
          
          
            <span class="date">25 Jan 2018</span>
          
        </div>

        <h1 class='title'>Amber - Crystalizing Rails and Phoenix</h1>
      </div>
      <div class="col m1"></div>
    </div>
  </div>
</div>
  <main><div class="container">
  <div class="row post-layout">
    <div class="col m2 share">
      <p class="title small share-title">Share</p>
      <div class="share-list">
        
        <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fja.crystal-lang.org%2F2018%2F01%2F25%2Famber-crystalizing-rails-and-phoenix.html&text=Amber+-+Crystalizing+Rails+and+Phoenix&via=CrystalLanguage" target="_blank">
          <div class="share-item"><i class="extra-icons twitter gray"></i></div>
        </a>
        <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fja.crystal-lang.org%2F2018%2F01%2F25%2Famber-crystalizing-rails-and-phoenix.html" target="_blank">
          <div class="share-item"><i class="extra-icons facebook gray"></i></div>
        </a>
        <a href="https://plus.google.com/share?url=https%3A%2F%2Fja.crystal-lang.org%2F2018%2F01%2F25%2Famber-crystalizing-rails-and-phoenix.html" target="_blank">
          <div class="share-item"><i class="extra-icons google_plus gray"></i></div>
          </a>
      </div>
    </div>

    <div class="col s12 m9">
      <blockquote>
  <p><em>This guest post by <a href="https://github.com/robacarp">Robert Carpenter</a> will introduce you to Amber, a Rails/Phoenix-like web framework for Crystal. Don’t forget to <a href="http://twitter.com/intent/tweet?text=@CrystalLanguage%20I%20want%20to%20write%20about...">reach out to us</a> if you want to share some experience of your own.</em></p>
</blockquote>

<p>The <a href="https://amberframework.org">Amber Framework</a> is a young and growing web framework written in our favorite language, Crystal. It shares many similarities with Rails, but - like Crystal itself - compatibility with Rails is not a design goal.</p>

<p>Here are a few reasons why I &lt;3 Amber:</p>

<ul>
  <li>Familiar framework design</li>
  <li>Compile time checks that save your sanity and maybe even your soul</li>
  <li>Open and welcoming framework development team</li>
  <li>Raw Speed</li>
</ul>

<h1 id="familiar-framework-design">Familiar Framework Design</h1>

<p>Amber projects follow similar design to Rails and other MVC focused web frameworks. It borrows organization and concepts where they’re successful and builds on that foundation where developer efficiency or simplicity can be improved.</p>

<p>Rails veterans will recognize many of these files and folders immediately:</p>

<div class="code_section">

<figure class="highlight"><pre><code class="language-plaintext" data-lang="plaintext">.. (up a dir)
&lt;/repositories/offline_pink/
▸ db/migrations/
▾ src/
  ▾ controllers/
  	application_controller.cr
  	user_controller.cr
  ▸ mailers/
  ▾ models/
  	user.cr
  ▾ views/
	▾ user/
    	  new.slang
    	  show.slang</code></pre></figure>

</div>

<p>Models, views, controllers, and migrations are all right where you’d expect them. You’ll feel right at home. Environment config files follow a familiar style and a working asset pipeline is available right out of the box, if you want it (thanks to webpack).</p>

<h1 id="compile-time-checks">Compile Time checks</h1>
<p>Thanks to Crystal, a large portion of an Amber project is evaluated at compile time. Never again get an email from production complaining about something so mundane as a <code class="language-plaintext highlighter-rouge">Missing Template</code>, <code class="language-plaintext highlighter-rouge">controller#action missing</code>, or <code class="language-plaintext highlighter-rouge">Undefined method .downcase for nil:NilClass</code>.</p>

<p>Amber even parses and compiles templates and layout files which not only verifies that the code is calling methods and getters safely, it saves a lot of time during a request.</p>

<p>Crystal does a great job of complaining when a method call on a variable isn’t valid for all possible types of that variable. Amber uses that power to ensure the application isn’t going to break at runtime wherever possible.</p>

<p>Observe what happens when compiling an Amber application with this broken template:</p>

<div class="code_section">

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="o">-</span> <span class="k">if</span> <span class="n">domain</span><span class="p">.</span><span class="nf">nam</span><span class="p">.</span><span class="nf">blank?</span>
  <span class="nb">p</span> <span class="no">No</span> <span class="n">domain</span> <span class="nb">name</span></code></pre></figure>

</div>

<p>The compiler complains, notifies you of the problem, and even suggests a correction:</p>

<div class="code_section">

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">in</span> <span class="n">macro</span> <span class="s1">'macro_4598546880'</span> <span class="n">expanded</span> <span class="ss">macro: </span><span class="n">embed</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">:</span>

<span class="o">&gt;</span>  <span class="mi">1</span><span class="p">.</span> <span class="nf">if</span> <span class="n">domain</span><span class="p">.</span><span class="nf">nam</span><span class="p">.</span><span class="nf">blank?</span>
   <span class="mi">2</span><span class="p">.</span> <span class="nf">__kilt_io__</span> <span class="o">&lt;&lt;</span> <span class="s2">"
   3. "</span>
   <span class="mi">4</span><span class="p">.</span> <span class="nf">__kilt_io__</span> <span class="o">&lt;&lt;</span> <span class="s2">"&lt;p"</span>
   <span class="mi">5</span><span class="p">.</span> <span class="nf">__kilt_io__</span> <span class="o">&lt;&lt;</span> <span class="s2">"&gt;"</span>
   <span class="mi">6</span><span class="p">.</span> <span class="nf">__kilt_io__</span> <span class="o">&lt;&lt;</span> <span class="no">HTML</span><span class="p">.</span><span class="nf">escape</span><span class="p">((</span><span class="s2">"No domain name"</span><span class="p">).</span><span class="nf">to_s</span><span class="p">).</span><span class="nf">to_s</span><span class="p">(</span><span class="n">__kilt_io__</span><span class="p">)</span>
   <span class="mi">7</span><span class="p">.</span> <span class="nf">__kilt_io__</span> <span class="o">&lt;&lt;</span> <span class="s2">"&lt;/p&gt;"</span>
   <span class="mi">8</span><span class="p">.</span> <span class="nf">end</span>

<span class="n">undefined</span> <span class="nb">method</span> <span class="s1">'nam'</span> <span class="k">for</span> <span class="no">Domain</span> <span class="p">(</span><span class="n">did</span> <span class="n">you</span> <span class="n">mean</span> <span class="s1">'name'</span><span class="p">?)</span></code></pre></figure>

</div>

<p>These compile time checks can save your sanity when an accidental typo slips its way into your routes file, or accidentally forgetting to commit a view template.</p>

<h1 id="open-and-welcoming-dev-team">Open and welcoming dev team</h1>
<p>The Amber project is <em>active</em>. Development on the tools, framework, libraries, and documentation is constant. Yet I’ve felt welcomed into the fold as an Amber contributor as the core team readily reviews and merges my pull requests, discusses framework direction and goals, and openly accepts suggestions and contributions from casual contributors as well as frequent benefactors.
This picture is from the <a href="https://github.com/amberframework/amber/pulse/monthly">Github Pulse</a> and shows how active the project has been this month:</p>

<p><img src="/assets/blog/amber-pulse.png" class="center" /></p>

<h1 id="raw-speed">Raw Speed</h1>
<p>Last but certainly not least, thanks to Crystal, Amber is <em><strong>fast</strong></em>. The compiled web is real, and it’s far more friendly now than ever before.</p>

<p>Check out this log excerpt from a project I’ve been working on:</p>

<div class="code_section">

<figure class="highlight"><pre><code class="language-plaintext" data-lang="plaintext">10:49:15 Request	| Started 2018-01-11 10:49:15 -07:00
10:49:15 Request	| Status: 200  Method: GET  Pipeline: web Format: html
10:49:15 Request	| Requested Url: /domain/30
10:49:15 Request	| Time Elapsed: 17.52ms</code></pre></figure>

</div>

<p>This particular request is <em>slow</em> by Amber standards, but it checks all the boxes:</p>

<ul>
  <li>SELECT queries across several tables<sup id="fnref:select" role="doc-noteref"><a href="#fn:select" class="footnote" rel="footnote">1</a></sup></li>
  <li>validating logged-in user session, and authenticating access for the request<sup id="fnref:validating" role="doc-noteref"><a href="#fn:validating" class="footnote" rel="footnote">2</a></sup></li>
  <li>rendering html views (not just JSON)<sup id="fnref:rendering" role="doc-noteref"><a href="#fn:rendering" class="footnote" rel="footnote">3</a></sup></li>
</ul>

<p>Compare to a page with similar database and rendering overhead in a Rails 5 application:</p>

<div class="code_section">

<figure class="highlight"><pre><code class="language-plaintext" data-lang="plaintext">processing by BookmarksController#index as HTML
Completed 200 OK in 251ms (Views: 217.9ms | ActiveRecord: 15.9ms)</code></pre></figure>

</div>

<p>That’s right. Thanks to the speed of Crystal, Amber can complete an entire request in about the same amount of time it takes Rails to query the database. That means each server can handle more traffic, is more resilient to denial of service, and every page is more responsive<sup id="fnref:unedited-logs" role="doc-noteref"><a href="#fn:unedited-logs" class="footnote" rel="footnote">4</a></sup>.</p>

<p>For a real sample of speed, this excerpt is from a basic Read route such as this:</p>

<div class="code_section">

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby">  <span class="k">def</span> <span class="nf">profile</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">current_user</span>
    <span class="n">render</span> <span class="s2">"show.slang"</span>
  <span class="k">end</span></code></pre></figure>

</div>

<div class="code_section">

<figure class="highlight"><pre><code class="language-plaintext" data-lang="plaintext">01:19:11 Request    | Started 2018-01-11 13:19:11 -07:00
01:19:11 Request    | Status: 200  Method: GET  Pipeline: web Format: html
01:19:11 Request    | Requested Url: /my/profile
01:19:11 Request    | Time Elapsed: 1.75ms</code></pre></figure>

</div>

<p>Or even faster, serving a static file:</p>

<div class="code_section">

<figure class="highlight"><pre><code class="language-plaintext" data-lang="plaintext">01:19:11 Request    | Started 2018-01-11 13:19:11 -07:00
01:19:11 Request    | Status: 200  Method: GET  Pipeline: static Format:
01:19:11 Request    | Requested Url: /dist/main.bundle.js
01:19:11 Request    | Time Elapsed: 329.0µs</code></pre></figure>

</div>

<p>Amazingly, because Amber views are compiled in, rendering a template and layout can be <em>significantly faster</em> than serving static files when the application is configured for it<sup id="fnref:configuration" role="doc-noteref"><a href="#fn:configuration" class="footnote" rel="footnote">5</a></sup>:</p>

<div class="code_section">

<figure class="highlight"><pre><code class="language-plaintext" data-lang="plaintext">01:45:15 Request	| Started 2018-01-17 13:45:15 -07:00
01:45:15 Request	| Status: 200  Method: GET  Pipeline: web Format: html
01:45:15 Request	| Requested Url: /
01:45:15 Request	| Time Elapsed: 371.0µs
01:45:16 Request	| Started 2018-01-17 13:45:15 -07:00
01:45:16 Request	| Status: 200  Method: GET  Pipeline: static Format: js
01:45:16 Request	| Requested Url: /dist/main.bundle.js
01:45:16 Request	| Time Elapsed: 80.01ms</code></pre></figure>

</div>

<p>No matter what your application is doing, Amber can do it <em>faster</em>.</p>

<h1 id="summary">Summary</h1>
<p>A lot of software is written for the web today. Ruby and Rails showed the world that development doesn’t need to be painful for developers. Crystal is a language where development ease meets speed, and Amber is a framework built on that tradition. Developer friendliness meets raw speed and power, for the web. Or to borrow from Amber’s tag-line: Productivity. Performance. Happiness.</p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:select" role="doc-endnote">
      <p><a href="https://gist.github.com/robacarp/d20ed807003d96e76a8538fab17e8af5#file-ab_crystal_logs-txt-L1">Relevant log</a> <a href="#fnref:select" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:validating" role="doc-endnote">
      <p><a href="https://gist.github.com/robacarp/d20ed807003d96e76a8538fab17e8af5#file-crystal_controller-cr">Relevant log</a> <a href="#fnref:validating" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:rendering" role="doc-endnote">
      <p><a href="https://gist.github.com/robacarp/d20ed807003d96e76a8538fab17e8af5#file-crystal_view-slim">Relevant log</a> <a href="#fnref:rendering" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:unedited-logs" role="doc-endnote">
      <p>Unedited logs and code samples comparing Rails and Amber <a href="https://gist.github.com/robacarp/d20ed807003d96e76a8538fab17e8af5">here</a> <a href="#fnref:unedited-logs" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:configuration" role="doc-endnote">
      <p>In order to render templates and views as fast as possible, the route pipeline must be slimmed down to almost nothing, rendering many features inoperable. <a href="#fnref:configuration" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

    </div>
    <div class="col m1"></div>
  </div>
</div>
</main><footer>
  <div class="row">
    <div class="col s12 m12 l6 crystal">
      Crystal is licensed under the Apache License,
      <a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>
        Version 2.0
      </a>
    </div>
    <div class="col s12 m12 l6 manas right-align black-text">
      Crystal language, born & raised at
      <a href="https://manas.tech" target="_blank" class="black-text">Manas</a>
      <a href="https://manas.tech" target="_blank" class="logo">
        <i class="manas"></i>
      </a>
    </div>
  </div>
</footer>
</div><script type="text/javascript" src="/assets/bundle.js"></script> <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-42353458-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
